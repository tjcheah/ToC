<!DOCTYPE html>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<style>

    table.table1 {
        border-collapse: collapse;
    }

    th, td {
        min-width: 30px;
        padding: 10px;
    }

    div.centerwrapper {
        margin-left: auto;
        margin-right: auto;
        max-width: 800px;
    }

    div.gallery {
        margin: 5px;
        border: 1px solid #ccc;
        float: left;
        width: 180px;
        display: inline-block;
    }

        div.gallery:hover {
            border: 1px solid #777;
        }

        div.gallery img {
            width: 100%;
            height: auto;
        }

    div.block {
        margin: 5px 5px 5px 5px;
        border: 1px solid #ccc;
        float: left;
        width: 192px;
        display: inline-block;
    }

    div.desc {
        padding: 15px;
        text-align: center;
    }

    div.RGinput {
        float: left;
        position: static;
    }

    #dynamic_table {
        position: static;
        margin-top: 5px;
        float: left;
        display: inline-block;
    }

    div.Checkstrings {
        position: static;
        margin-left: 800px;
        margin-top: 25px;
    }
</style>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>

    <div class="container">
        <h2>Assignment</h2>
        <p>TIC2151 - Theory of Computation</p>

        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#home">Home</a></li>
            <li><a data-toggle="tab" href="#RgtoNfa">RG -> NFA</a></li>
            <li><a data-toggle="tab" href="#NfatoRg">NFA -> RG</a></li>
            <li><a data-toggle="tab" href="helpDoc">Help + Doc</a></li>
        </ul>

        <div class="tab-content">
            <div id="home" class="tab-pane fade in active" style="text-align:center;">
                <h3 style="text-align:center;">Theory of Computation</h3>
                <div class="centerwrapper">
                    <div class="block">
                        <div class="gallery">
                            <a target="_blank" href="img_forest.jpg">
                                <img src="img_forest.jpg" width="600" height="400">
                            </a>
                            <div class="desc">Leader</div>
                        </div>
                    </div>
                    <div class="gallery">
                        <a target="_blank" href="tati.jpg">
                            <img src="tati.jpg" width="600" height="400">
                        </a>
                        <div class="desc">Tatiana Joanne Cheah (1161104048)</div>
                    </div>

                    <div class="gallery">
                        <a target="_blank" href="img_lights.jpg">
                            <img src="img_lights.jpg" alt="Northern Lights" width="600" height="400">
                        </a>
                        <div class="desc">Add member details here</div>
                    </div>

                    <div class="gallery">
                        <a target="_blank" href="img_mountains.jpg">
                            <img src="img_mountains.jpg" alt="Mountains" width="600" height="400">
                        </a>
                        <div class="desc">Add member details here</div>
                    </div>
                </div>
            </div>
            <div id="RgtoNfa" class="tab-pane fade">
                <!-- Input for RG -->
                <div class="RGinput">
                    <h5>Regular Grammar (input - here is &epsilon; symbol to paste when needed)</h5>
                    <table class="table1 table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">State</th>
                                <th scope="col">Transition</th>
                                <th colspan="9" style="text-align:center;">Variables</th>
                            </tr>
                            <tr>
                                <td><input type="text" id="s1" maxlength="1" size="1"></td>
                                <td><p style="text-align:center;">&rarr;</p></td>
                                <td><input type="text" id="v11" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v12" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v13" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v14" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v15" maxlength="2" size="4"></td>
                            </tr>
                            <tr>
                                <td><input type="text" id="s2" maxlength="1" size="1"></td>
                                <td><p style="text-align:center;">&rarr;</p></td>
                                <td><input type="text" id="v21" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v22" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v23" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v24" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v25" maxlength="2" size="4"></td>
                            </tr>
                            <tr>
                                <td><input type="text" id="s3" maxlength="1" size="1"></td>
                                <td><p style="text-align:center;">&rarr;</p></td>
                                <td><input type="text" id="v31" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v32" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v33" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v34" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v35" maxlength="2" size="4"></td>
                            </tr>
                            <tr>
                                <td><input type="text" id="s4" maxlength="1" size="1"></td>
                                <td><p style="text-align:center;">&rarr;</p></td>
                                <td><input type="text" id="v41" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v42" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v43" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v44" maxlength="2" size="4"></td>
                                <td><p style="text-align:center;">&#x7c;</p></td>
                                <td><input type="text" id="v45" maxlength="2" size="4"></td>
                            </tr>
                        </thead>
                    </table>
                    <button id="RG_submit" style="margin-top:5px;">Convert RG into NFA</button>
                </div>
                <div class="Checkstrings">
                    <h5>Check String (input)</h5>
                    <textarea name="RG" cols="20" rows="5" style="resize:none;"></textarea>
                    <br>
                    <button id="Checkstring1">Check</button>
                </div>
                <br>
                <br>
                <br>
                <br>
                <table id="dynamic_table">
                    <tr>
                        <td>
                            <div id="formal_def"></div>
                        </td>
                        <td>
                            <div id="trans_table"></div>
                        </td>
                    </tr>
                </table>
                <script>
                    $(document).ready(function () {
                        $('#RG_submit').click(function () {
                            console.log("clicked")
                            document.getElementById("formal_def").innerHTML = "";
                            var check_states = function (a, start, end) {
                                if (a != start) {
                                    return a;
                                }
                                else if (a === start) {
                                    a = "> " + a;
                                    return a;
                                }
                                else if (a === end) {
                                    a = "* " + a;
                                    return a;
                                }
                            }

                            var check_final = function (a, prev) {
                                if (a != "") {
                                    return a
                                }
                                else {
                                    return prev
                                }
                            }
                            //determine states
                            var start = $('#s1').val();
                            var end = check_final($('#s2').val(), start);
                            var end = check_final($('#s3').val(), end);
                            var end = check_final($('#s4').val(), end);


                            //for presenting states in transition table
                            var st1 = check_states($('#s1').val(), start, end);
                            var st2 = check_states($('#s2').val(), start, end);
                            var st3 = check_states($('#s3').val(), start, end);
                            var st4 = check_states($('#s4').val(), start, end);

                            let states = [];
                            states.push(start, st2, st3, st4);
                            let list_states = [];
                            for (i = 0; i < 4; i++) {
                                if (states[i] != "") {
                                    list_states.push(states[i]);
                                }
                            }

                            //determine alphabets
                            let list1 = [];
                            let list2 = [];
                            let list3 = [];
                            let alphas = [];
                            let symbols = [];
                            var vtext = "#v";

                            for (i = 1; i < 5; i++) {
                                for (j = 1; j < 6; j++) {
                                    list1.push($(vtext + i + j).val());
                                }
                            }

                            var found = 0;
                            var eps = 'ε';
                            var empt = '∅';

                            //looks out for lowercase letters
                            for (x = 0; x < 20; x++) {
                                if (list1[x] != "") {
                                    list3 = list1[x].split('');
                                    for (y = 0; y < list3.length; y++) {
                                        if (/[a-z]/.test(list3[y])) {
                                            for (w = 0; w <= list2.length; w++) {
                                                console.log("list3 is "+list3[y]);
                                                console.log("list2 is "+list2[y]);
                                                console.log("w is "+w);
                                                console.log("y is "+y);
                                                if (list2[w] == list3[y]) {
                                                    found = 1;
                                                }
                                            }
                                            if (found == 0) {
                                                list2.push(list3[y]);
                                                symbols.push(list3[y]);
                                            }
                                        }
                                        else if (list3[y] == eps) {//add star to a state with epsilon to mark it as accept state
                                            if (x < 5) {
                                                st1 = "*" + st1;
                                                list_states.splice(0, 1, st1);
                                            }
                                            else if (x > 4 && x < 10) {
                                                st2 = "*" + st2;
                                                list_states.splice(1, 1, st2);
                                            }
                                            else if (x > 9 && x < 15) {
                                                st3 = "*" + st3;
                                                list_states.splice(2, 1, st3);
                                            }
                                        }
                                        found = 0;
                                    }
                                }
                                list3 = [];
                            }
                            for (x = 0; x < list2.length; x++) {
                                alphas.push(list2[x]);
                            }

                            //determine transition for each state
                            var list4 = [];
                            var trans1 = [];
                            var trans2 = [];
                            var trans3 = [];
                            var trans4 = [];

                            var got_emp = 0;
                            for (x = 0; x < 20; x++) {
                                if (x >= 0 && x < 5) {
                                    if (list1[x].match(/[a-z][A-Z]/g)) {//push those in format aB
                                        trans1.push(list1[x]);
                                    }
                                    else if (list1[x].match(/[A-Z]/g)) {//ensure format A is place under epsilon
                                        trans1.push(list1[x]);
                                        if (got_emp == 0) {
                                            for (y = 0; y < list_states.length; y++) {
                                                if (list_states[y] == eps) {
                                                    got_emp = 1;
                                                }
                                            }
                                            if (got_emp == 0) {
                                                symbols.push(eps);
                                                got_emp = 1;
                                            }
                                        }
                                    }
                                }
                                if (x >= 5 && x < 10) {
                                    if (list1[x].match(/[a-z][A-Z]/g)) {
                                        trans2.push(list1[x]);
                                    }
                                    else if (list1[x].match(/[A-Z]/g)) {
                                        trans2.push(list1[x]);
                                        if (got_emp == 0) {
                                            for (y = 0; y < list_states.length; y++) {
                                                if (list_states[y] == eps) {
                                                    got_emp = 1;
                                                }
                                            }
                                            if (got_emp == 0) {
                                                symbols.push(eps);
                                                got_emp = 1;
                                            }
                                        }
                                    }
                                }
                                if (x >= 10 && x < 15) {
                                    if (list1[x].match(/[a-z][A-Z]/g)) {
                                        trans3.push(list1[x]);
                                    }
                                    else if (list1[x].match(/[A-Z]/g)) {
                                        trans3.push(list1[x]);
                                        if (got_emp == 0) {
                                            for (y = 0; y < list_states.length; y++) {
                                                if (list_states[y] == eps) {
                                                    got_emp = 1;
                                                }
                                            }
                                            if (got_emp == 0) {
                                                symbols.push(eps);
                                                got_emp = 1;
                                            }
                                        }
                                    }
                                }
                                if (x >= 15 && x < 20) {
                                    if (list1[x].match(/[a-z][A-Z]/g)) {
                                        trans4.push(list1[x]);
                                    }
                                    else if (list1[x].match(/[A-Z]/g)) {
                                        trans4.push(list1[x]);
                                        if (got_emp == 0) {
                                            for (y = 0; y < list_states.length; y++) {
                                                if (list_states[y] == eps) {
                                                    got_emp = 1;
                                                }
                                                y++
                                            }
                                            if (got_emp == 0) {
                                                symbols.push(eps);
                                                got_emp = 1;
                                            }
                                        }
                                    }
                                    else if (x == symbols.length + 14) {
                                        if (list4.length > 0) {
                                            trans3.push(list4[0]);
                                            list4 = [];
                                        }
                                    }
                                }
                            }

                            //display formal definition of language
                            $('#formal_def').append('<p><b>M = (Q, &Sigma;, &delta;, p<sub>0</sub>, F)</b><br>Q ={' + list_states.join(", ") + '}<br>&Sigma; = {' + alphas.join(", ") + '}<br>&delta;: Q &times; &sum;<sub>&epsilon;</sub> &rarr; Pow(Q)<br>p<sub>0</sub> = ' + start + '<br>F = {' + end + '}<p>');

                            //creating dynamic table for NFA
                            document.getElementById("trans_table").innerHTML = "<table class='table1 table-bordered' id='trans_bordered'></table>";

                            var body = document.body,
                                tbl = document.getElementById('trans_bordered');


                            found = 0;
                            for (var m = 0; m < list_states.length + 1; m++) {
                                var tr = tbl.insertRow();
                                for (var n = 0; n < symbols.length + 1; n++) {
                                    var td = tr.insertCell();
                                    if (n >= 1 && m == 0) {
                                        // put all the variable to the most top of the table
                                        td.appendChild(document.createTextNode(symbols[n - 1]));
                                    } else if (m != 0 && n == 0) {
                                        // put all the state name to the most left of the table
                                        var compare = list_states[m - 1];
                                        if (compare == start) {
                                            // if the state is the initial state
                                            compare = ">" + compare;
                                        }
                                        if (compare == end) {
                                            // if the state is the final state
                                            compare = "*" + compare;
                                        }
                                        td.appendChild(document.createTextNode(compare));
                                    } else if (n == 0 && m == 0) {
                                        state = "δ";
                                        td.appendChild(document.createTextNode(state));
                                    }
                                    else if (n <= symbols.length && m == 1) {//loops the transition list for that row in each cell to match to the right place
                                        for (y = 0; y < trans1.length; y++) {
                                            if (symbols[n - 1].match(/[a-z]/g)) {
                                                var str = new RegExp(symbols[n - 1], "g");
                                                if (trans1[y].match(str)) {
                                                    state = trans1[y];
                                                    td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                    found = 1;
                                                    break;
                                                }
                                            }
                                            else if (trans1[y].match(/[A-Z]/g) && trans1[y].length == 1) {
                                                state = trans1[y];
                                                td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                found = 1;
                                                break;
                                            }
                                        }
                                        if (found == 0) {//if there are no match, an empty set symbol is slotted in
                                            state = empt;
                                            td.appendChild(document.createTextNode(state));
                                        }
                                        else {//if match is found, found variable is reset 
                                            found = 0;
                                            console.log("found is reset");
                                        }
                                    }
                                    else if (n <= symbols.length && m == 2) {
                                        console.log("trans2 length is " + trans2.length);
                                        for (y = 0; y < trans2.length; y++) {
                                            if (symbols[n - 1].match(/[a-z]/g)) {
                                                var str = new RegExp(symbols[n - 1], "g");
                                                if (trans2[y].match(str)) {
                                                    state = trans2[y];
                                                    td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                    found = 1;
                                                    break;
                                                }
                                            }
                                            else if (trans2[y].match(/[A-Z]/g) && trans2[y].length == 1) {
                                                state = trans2[y];
                                                td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                found = 1;
                                                break;
                                            }
                                        }
                                        if (found == 0) {
                                            state = empt;
                                            td.appendChild(document.createTextNode(state));
                                        }
                                        else {
                                            found = 0;
                                        }
                                    }
                                    else if (n <= symbols.length && m == 3) {
                                        for (y = 0; y < trans3.length; y++) {
                                            if (symbols[n - 1].match(/[a-z]/g)) {
                                                var str = new RegExp(symbols[n - 1], "g");
                                                if (trans3[y].match(str)) {
                                                    state = trans3[y];
                                                    td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                    found = 1;
                                                    break;
                                                }
                                            }
                                            else if (trans3[y].match(/[A-Z]/g) && trans3[y].length == 1) {
                                                state = trans3[y];
                                                td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                found = 1;
                                                break;
                                            }
                                        }
                                        if (found == 0) {
                                            state = empt;
                                            td.appendChild(document.createTextNode(state));
                                        }
                                        else {
                                            found = 0;
                                        }
                                    }
                                    else if (n <= symbols.length && m == 4) {
                                        for (y = 0; y < trans4.length; y++) {
                                            if (symbols[n - 1].match(/[a-z]/g)) {
                                                var str = new RegExp(symbols[n - 1], "g");
                                                if (trans4[y].match(str)) {
                                                    state = trans4[y];
                                                    td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                    found = 1;
                                                    break;
                                                }
                                            }
                                            else if (trans4[y].match(/[A-Z]/g) && trans4[y].length == 1) {
                                                state = trans4[y];
                                                td.appendChild(document.createTextNode(state.match(/[A-Z]/g)));
                                                found = 1;
                                                break;
                                            }
                                        }
                                        if (found == 0) {
                                            state = empt;
                                            td.appendChild(document.createTextNode(state));
                                        }
                                        else {
                                            found = 0;
                                        }
                                    }
                                }
                            }
                        })
                    });
                </script>
            </div>
            <div id="NfatoRg" class="tab-pane fade">
                <h3>Menu 2</h3>
                <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.</p>
            </div>
            <div id="helpDoc" class="tab-pane fade">
                <h3>Menu 3</h3>
                <p>Eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
            </div>
        </div>
    </div>

</body>
</html>
